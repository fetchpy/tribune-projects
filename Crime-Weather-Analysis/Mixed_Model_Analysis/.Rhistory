data$Primary.Type
if(data$Primary.Type==NA,1)
setwd('/Users/Mowafak/Documents/Tribune/weather_Temp & shootings/Stats Analysis/')
data <- read.csv('temp_reg_analysis.csv')
data$X <- NULL
crimeType <-c('THEFT', 'BATTERT', 'CRIMINAL DAMAGE', 'NARCOTICS', 'ASSAULT', 'MOTOR VEHICLE THEFT', 'ROBERRY','BURGLARY')
data$Primary.Type[data$Primary.Type %!in% crimeType]<-'Other'
View(data)
dat<-data$Primary.Type[data$Primary.Type %!in% crimeType]
dat<-data$Primary.Type[data$Primary.Type %nin% crimeType]
data$Primary.Type %nin% crimeType
data$Primary.Type %!in% crimeType
dat<-data$Primary.Type[data$Primary.Type %nin% crimeType]
data$Primary.Type[(data$Primary.Type %!in% crimeType)]<-'Other'
View(data)
setwd('/Users/Mowafak/Documents/Tribune/weather_Temp & shootings/Stats Analysis/')
data <- read.csv('temp_reg_analysis.csv')
data$X <- NULL
crimeType <-c('THEFT', 'BATTERT', 'CRIMINAL DAMAGE', 'NARCOTICS', 'ASSAULT', 'MOTOR VEHICLE THEFT', 'ROBERRY','BURGLARY')
data$Primary.Type[(data$Primary.Type %!in% crimeType)]<-'Other'
View(data)
data$Primary.Type<-data$Primary.Type[(data$Primary.Type %!in% crimeType)]<-'Other'
View(data)
library(lme4)
library (ggplot2)
setwd('/Users/Mowafak/Documents/Tribune/weather_Temp & shootings/Stats Analysis/')
data <- read.csv('temp_reg_analysis.csv')
data$X <- NULL
crimeType <-c('THEFT', 'BATTERT', 'CRIMINAL DAMAGE', 'NARCOTICS', 'ASSAULT', 'MOTOR VEHICLE THEFT', 'ROBERRY','BURGLARY')
data$Primary.Type<-data$Primary.Type[(data$Primary.Type %!in% crimeType)]<-'Other'
View(data)
data$Primary.Type<-data$Primary.Type[(data$Primary.Type %in% crimeType)]<-'Other'
data$Primary.Type[data$Primary.Type=='NA']
data$Primary.Type[data$Primary.Type=='Other']
library(lme4)
library (ggplot2)
setwd('/Users/Mowafak/Documents/Tribune/weather_Temp & shootings/Stats Analysis/')
data <- read.csv('temp_reg_analysis.csv')
data$X <- NULL
crimeType <-c('THEFT', 'BATTERT', 'CRIMINAL DAMAGE', 'NARCOTICS', 'ASSAULT', 'MOTOR VEHICLE THEFT', 'ROBERRY','BURGLARY')
data$Primary.Type<-data$Primary.Type[(data$Primary.Type %out% crimeType)]<-'Other'
View(daa)
View(data)
data$Primary.Type
data$Primary.Type<-data$Primary.Type[data$Primary.Type %out% crimeType]<-'Other'
data$Primary.Type<-data$Primary.Type[data$Primary.Type %nin% crimeType]<-'Other'
View(data)
%nin
%nin%
data$Primary.Type<-data$Primary.Type[data$Primary.Type %in% crimeType]
data$Primary.Type %in% crimeType
data$Primary.Type[data$Primary.Type %in% crimeType]
ifelse(data$Primary.Type[data$Primary.Type %in% crimeType], ifelse(data$Primary.Type[data$Primary.Type %in% crimeType], 'Other'))
p<-ifelse(data$Primary.Type[data$Primary.Type %in% crimeType], ifelse(data$Primary.Type[data$Primary.Type %in% crimeType], 'Other'))
p
data$Primary.Type[data$Primary.Type %in% crimeType]
data$Primary.Type[data$Primary.Type %!in% crimeType]
data$Primary.Type %!in% crimeType
data$Primary.Type "%!in%" crimeType
data$Primary.Type (%!in%) crimeType
data$Primary.Type<-data$Primary.Type[data$Primary.Type `%in%` crimeType]
data$Primary.Type<-data$Primary.Type[data$Primary.Type '%in%' crimeType]
data$Primary.Type[!(data$Primary.Type %in%  crimeType)]
data$Primary.Type<-data$Primary.Type[!(data$Primary.Type %in%  crimeType)]<-'Other'
library(lme4)
library (ggplot2)
setwd('/Users/Mowafak/Documents/Tribune/weather_Temp & shootings/Stats Analysis/')
data <- read.csv('temp_reg_analysis.csv')
data$X <- NULL
data$Primary.Type <- factor(data$Primary.Type)
crimeType <-c('THEFT', 'BATTERT', 'CRIMINAL DAMAGE', 'NARCOTICS', 'ASSAULT', 'MOTOR VEHICLE THEFT', 'ROBERRY','BURGLARY')
data$Primary.Type[!(data$Primary.Type %in%  crimeType)]<-'Other'
View(data)
data$Primary.Type[!(data$Primary.Type %in%  crimeType)]<-c('Other')
data$Primary.Type[!(data$Primary.Type %in%  crimeType)]<-str('Other')
View(data)
library(lme4)
library (ggplot2)
setwd('/Users/Mowafak/Documents/Tribune/weather_Temp & shootings/Stats Analysis/')
data <- read.csv('temp_reg_analysis.csv')
data$X <- NULL
# sM<-lm(Count ~ Primary.Type + Mean_Temp+Month+Year,data=data)
#
# data$Year<-factor(data$Year)
# data$Month<-factor(data$Month)
data$Primary.Type <- factor(data$Primary.Type)
# data$Day <- factor(data$Day
crimeType <-c('THEFT', 'BATTERT', 'CRIMINAL DAMAGE', 'NARCOTICS', 'ASSAULT', 'MOTOR VEHICLE THEFT', 'ROBERRY','BURGLARY')
data$Primary.Type[!(data$Primary.Type %in%  crimeType)]<-str('Other')
data$Primary.Type[!(data$Primary.Type %in%  crimeType)]
data$Primary.Type[!(data$Primary.Type %in%  crimeType)]<-1
data$Primary.Type[!(data$Primary.Type %in%  crimeType)]<-c('Other',len(data$Primary.Type))
data$Primary.Type[!(data$Primary.Type %in%  crimeType)]<-c('Other',lenght(data$Primary.Type))
data$Primary.Type[!(data$Primary.Type %in%  crimeType)]<-c('Other',length(data$Primary.Type))
type()
View(data)
library(lme4)
library (ggplot2)
setwd('/Users/Mowafak/Documents/Tribune/weather_Temp & shootings/Stats Analysis/')
data <- read.csv('temp_reg_analysis.csv')
data$X <- NULL
data$Primary.Type <- factor(data$Primary.Type)
crimeType <-c('THEFT', 'BATTERT', 'CRIMINAL DAMAGE', 'NARCOTICS', 'ASSAULT', 'MOTOR VEHICLE THEFT', 'ROBERRY','BURGLARY')
data$Primary.Type[!(data$Primary.Type %in%  crimeType)]
library(lme4)
library (ggplot2)
setwd('/Users/Mowafak/Documents/Tribune/weather_Temp & shootings/Stats Analysis/')
data <- read.csv('temp_reg_analysis.csv')
data$X <- NULL
crimeType <-c('THEFT', 'BATTERT', 'CRIMINAL DAMAGE', 'NARCOTICS', 'ASSAULT', 'MOTOR VEHICLE THEFT', 'ROBERRY','BURGLARY')
data$Primary.Type[!(data$Primary.Type %in%  crimeType)]<-'Other'
levels(data$Primary.Type)
levels(data$Primary.Type) <- c(levels(data$Primary.Type),'Other')
View(data)
View(data)
library(lme4)
library (ggplot2)
setwd('/Users/Mowafak/Documents/Tribune/weather_Temp & shootings/Stats Analysis/')
data <- read.csv('temp_reg_analysis.csv')
data$X <- NULL
levels(data$Primary.Type) <- c(levels(data$Primary.Type),'Other')
crimeType <-c('THEFT', 'BATTERT', 'CRIMINAL DAMAGE', 'NARCOTICS', 'ASSAULT', 'MOTOR VEHICLE THEFT', 'ROBERRY','BURGLARY')
data$Primary.Type[!(data$Primary.Type %in%  crimeType)]<-'Other'
view(data)
View(data)
mlm.2 <- lmer(Count~Mean_Temp*Primary.Type+(1|Year)+(1|Primary.Type),data=data,REML = FALSE)
summary(mlm.2)
summary(mlm.2)
lmerControl("Other")
mlm.2 <- lmer(Count~Mean_Temp*Primary.Type+(1|Year)+(1|Primary.Type),data=data,REML = FALSE)
summary(mlm.2)
?relevel()
levels(data$Primary.Type)
data <-within(data,data$Primary.Type<-relevel(data$Primary.Type,ref=34))
mlm.2 <- lmer(Count~Mean_Temp*Primary.Type+(1|Year)+(1|Primary.Type),data=data,REML = FALSE)
summary(mlm.2)
data2 <-within(data,data$Primary.Type<-relevel(data$Primary.Type,ref=34))
levels(data)
levels(data2$Primary.Type)
mlm.2 <- lmer(Count~Mean_Temp*Primary.Type+(1|Year)+(1|Primary.Type),data=data2,REML = FALSE)
summary(mlm.2)
library(lme4)
library (ggplot2)
setwd('/Users/Mowafak/Documents/Tribune/weather_Temp & shootings/Stats Analysis/')
data <- read.csv('temp_reg_analysis.csv')
data$X <- NULL
# sM<-lm(Count ~ Primary.Type + Mean_Temp+Month+Year,data=data)
#
# data$Year<-factor(data$Year)
# data$Month<-factor(data$Month)
data$Primary.Type <- factor(data$Primary.Type)
# data$Day <- factor(data$Day)
#
levels(data$Primary.Type) <- c(levels(data$Primary.Type),'Other')
crimeType <-c('THEFT', 'BATTERT', 'CRIMINAL DAMAGE', 'NARCOTICS', 'ASSAULT', 'MOTOR VEHICLE THEFT', 'ROBERRY','BURGLARY')
data$Primary.Type[!(data$Primary.Type %in%  crimeType)]<-'Other'
data2 <-within(data,data$Primary.Type<-relevel(data$Primary.Type,ref=34))
mlm.2 <- lmer(Count~Mean_Temp*Primary.Type+(1|Year)+(1|Primary.Type),data=data2,REML = FALSE)
summary(mlm.2)
mlm.2 <- lmer(Count~Mean_Temp*Primary.Type+(1|Year)+(1|Primary.Type),data=data,REML = FALSE)
summary(mlm.2)
data2 <-within(data,data$Primary.Type<-relevel(data$Primary.Type,ref=1))
mlm.2 <- lmer(Count~Mean_Temp*Primary.Type+(1|Year)+(1|Primary.Type),data=data,REML = FALSE)
summary(mlm.2)
data2$Primary.Type
levels(data2$Primary.Type)
library(lme4)
library (ggplot2)
setwd('/Users/Mowafak/Documents/Tribune/weather_Temp & shootings/Stats Analysis/')
data <- read.csv('temp_reg_analysis.csv')
data$X <- NULL
# sM<-lm(Count ~ Primary.Type + Mean_Temp+Month+Year,data=data)
#
# data$Year<-factor(data$Year)
# data$Month<-factor(data$Month)
data$Primary.Type <- factor(data$Primary.Type)
# data$Day <- factor(data$Day)
#
#
# sM<-lm(Count ~  Primary.Type+Mean_Temp+Month+Year+Mean_Temp*Primary.Type  -1 ,data=data)
######still not working########
# crimePlot <- ggplot(data=data,aes(x=Mean_Temp,y=Count,group=Year))+
#   facet_grid(Count~Mean_Temp)+
#   geom_point(aes(colour=Primary.Type))+
#   geom_smooth(method="lm",se=TRUE,aes(colour=Primary.Type))+
#   xlab('Temp')+ylab('Crime Count')+
#   theme(legend.position="none")
# crimePlot
##############################
#RM measures need to stand independently
#temp <- subset(data,data$Primary.Type=='BATTERY')
mlm <- lmer(Count~1+(1|Year)+(1|Month),data=data,REML = FALSE)
summary(mlm)
ranef(mlm)
#general trend
#effect of temp controlling for year and type of crime.
#(1+Mean_Temp|Year) each year has its own mean and each has its own slope of mean_temp. Slope of temp will vary as a function of year.
mlm.1 <- lmer(Count~poly(Mean_Temp,2,raw = TRUE)+(1|Year)+(1|Primary.Type),data=data,REML = FALSE)
summary(mlm.1)
ranef(mlm.1)
#the fixed effects explain that e.g: interaction temp with assult is 0.338060
# the slopes is being compared with Temp*Arson. This has to be changed to the grand mean.
#This is the working model. You can delete (1|Primary.Type) because the interaction term is sucking all of its variance.
mlm.2 <- lmer(Count~Mean_Temp*Primary.Type+(1|Year)+(1|Primary.Type),data=data,REML = FALSE)
library(lme4)
library (ggplot2)
setwd('/Users/Mowafak/Documents/Tribune/weather_Temp & shootings/Stats Analysis/')
data <- read.csv('temp_reg_analysis.csv')
data$X <- NULL
# sM<-lm(Count ~ Primary.Type + Mean_Temp+Month+Year,data=data)
#
# data$Year<-factor(data$Year)
# data$Month<-factor(data$Month)
data$Primary.Type <- factor(data$Primary.Type)
# data$Day <- factor(data$Day)
#
#
# sM<-lm(Count ~  Primary.Type+Mean_Temp+Month+Year+Mean_Temp*Primary.Type  -1 ,data=data)
######still not working########
# crimePlot <- ggplot(data=data,aes(x=Mean_Temp,y=Count,group=Year))+
#   facet_grid(Count~Mean_Temp)+
#   geom_point(aes(colour=Primary.Type))+
#   geom_smooth(method="lm",se=TRUE,aes(colour=Primary.Type))+
#   xlab('Temp')+ylab('Crime Count')+
#   theme(legend.position="none")
# crimePlot
##############################
#RM measures need to stand independently
#temp <- subset(data,data$Primary.Type=='BATTERY')
mlm <- lmer(Count~1+(1|Year)+(1|Month),data=data,REML = FALSE)
summary(mlm)
ranef(mlm)
#general trend
#effect of temp controlling for year and type of crime.
#(1+Mean_Temp|Year) each year has its own mean and each has its own slope of mean_temp. Slope of temp will vary as a function of year.
mlm.1 <- lmer(Count~poly(Mean_Temp,2,raw = TRUE)+(1|Year)+(1|Primary.Type),data=data,REML = FALSE)
summary(mlm.1)
ranef(mlm.1)
#the fixed effects explain that e.g: interaction temp with assult is 0.338060
# the slopes is being compared with Temp*Arson. This has to be changed to the grand mean.
#This is the working model. You can delete (1|Primary.Type) because the interaction term is sucking all of its variance.
#mlm.2 <- lmer(Count~Mean_Temp*Primary.Type+(1|Year)+(1|Primary.Type),data=data,REML = FALSE)
#compare shootings and battery to other crimes. Label other crimes as "other" and then label the column as foo.
#replace Primar.Type with foo.
summary(mlm.2)
ranef(mlm.2)
####Dummy code the variables
levels(data$Primary.Type) <- c(levels(data$Primary.Type),'Other')
crimeType <-c('THEFT', 'BATTERT', 'CRIMINAL DAMAGE', 'NARCOTICS', 'ASSAULT', 'MOTOR VEHICLE THEFT', 'ROBERRY','BURGLARY')
data$Primary.Type[!(data$Primary.Type %in%  crimeType)]<-'Other'
dat2<-data
levels(dat2)
levels(dat2$Primary.Type)
library(lme4)
library (ggplot2)
setwd('/Users/Mowafak/Documents/Tribune/weather_Temp & shootings/Stats Analysis/')
data <- read.csv('temp_reg_analysis.csv')
data$X <- NULL
# sM<-lm(Count ~ Primary.Type + Mean_Temp+Month+Year,data=data)
#
# data$Year<-factor(data$Year)
# data$Month<-factor(data$Month)
data$Primary.Type <- factor(data$Primary.Type)
# data$Day <- factor(data$Day)
#
#
# sM<-lm(Count ~  Primary.Type+Mean_Temp+Month+Year+Mean_Temp*Primary.Type  -1 ,data=data)
######still not working########
# crimePlot <- ggplot(data=data,aes(x=Mean_Temp,y=Count,group=Year))+
#   facet_grid(Count~Mean_Temp)+
#   geom_point(aes(colour=Primary.Type))+
#   geom_smooth(method="lm",se=TRUE,aes(colour=Primary.Type))+
#   xlab('Temp')+ylab('Crime Count')+
#   theme(legend.position="none")
# crimePlot
##############################
#RM measures need to stand independently
#temp <- subset(data,data$Primary.Type=='BATTERY')
mlm <- lmer(Count~1+(1|Year)+(1|Month),data=data,REML = FALSE)
summary(mlm)
ranef(mlm)
#general trend
#effect of temp controlling for year and type of crime.
#(1+Mean_Temp|Year) each year has its own mean and each has its own slope of mean_temp. Slope of temp will vary as a function of year.
mlm.1 <- lmer(Count~poly(Mean_Temp,2,raw = TRUE)+(1|Year)+(1|Primary.Type),data=data,REML = FALSE)
summary(mlm.1)
ranef(mlm.1)
#the fixed effects explain that e.g: interaction temp with assult is 0.338060
# the slopes is being compared with Temp*Arson. This has to be changed to the grand mean.
#This is the working model. You can delete (1|Primary.Type) because the interaction term is sucking all of its variance.
#mlm.2 <- lmer(Count~Mean_Temp*Primary.Type+(1|Year)+(1|Primary.Type),data=data,REML = FALSE)
#compare shootings and battery to other crimes. Label other crimes as "other" and then label the column as foo.
#replace Primar.Type with foo.
summary(mlm.2)
ranef(mlm.2)
####Dummy code the variables
levels(data$Primary.Type) <- c(levels(data$Primary.Type),'Other')
crimeType <-c('THEFT', 'BATTERT', 'CRIMINAL DAMAGE', 'NARCOTICS', 'ASSAULT', 'MOTOR VEHICLE THEFT', 'ROBERRY','BURGLARY')
data$Primary.Type<-data$Primary.Type[!(data$Primary.Type %in%  crimeType)]<-'Other'
dat2<-data
dat2
levels(dat2)
levels(dat2$Primary.Type)
view(dat2)
View(dat2)
library(lme4)
library (ggplot2)
setwd('/Users/Mowafak/Documents/Tribune/weather_Temp & shootings/Stats Analysis/')
data <- read.csv('temp_reg_analysis.csv')
data$X <- NULL
# sM<-lm(Count ~ Primary.Type + Mean_Temp+Month+Year,data=data)
#
# data$Year<-factor(data$Year)
# data$Month<-factor(data$Month)
data$Primary.Type <- factor(data$Primary.Type)
# data$Day <- factor(data$Day)
#
#
# sM<-lm(Count ~  Primary.Type+Mean_Tem
levels(data$Primary.Type) <- c(levels(data$Primary.Type),'Other')
crimeType <-c('THEFT', 'BATTERT', 'CRIMINAL DAMAGE', 'NARCOTICS', 'ASSAULT', 'MOTOR VEHICLE THEFT', 'ROBERRY','BURGLARY')
m<-data$Primary.Type[!(data$Primary.Type %in%  crimeType)]<-'Other'
m
m
data$Primary.Type[!(data$Primary.Type %in%  crimeType)]<-'Other'
View(data)
levels(data$Primary.Type)
relevel(data$Primary.Type)
data2 <-within(data,data$Primary.Type<-relevel(data$Primary.Type,ref='Other'))
mlm.2 <- lmer(Count~Mean_Temp*Primary.Type+(1|Year)+(1|Primary.Type),data=data,REML = FALSE)
summary(mlm.2)
data2 <-within(data,data$Primary.Type<-relevel(data$Primary.Type,ref='BURGLARY'))
mlm.2 <- lmer(Count~Mean_Temp*Primary.Type+(1|Year)+(1|Primary.Type),data=data,REML = FALSE)
summary(mlm.2)
typeof(data2)
typeof(data)
data$Primary.Type<-relevel(data$Primary.Type,ref='BURGLARY'))
data$Primary.Type<-relevel(data$Primary.Type,ref='BURGLARY')
mlm.2 <- lmer(Count~Mean_Temp*Primary.Type+(1|Year)+(1|Primary.Type),data=data,REML = FALSE)
summary(mlm.2)
data$Primary.Type<-relevel(data$Primary.Type,ref='Other')
mlm.2 <- lmer(Count~Mean_Temp*Primary.Type+(1|Year)+(1|Primary.Type),data=data,REML = FALSE)
summary(mlm.2)
summary(mlm.2)
z<- c('THEFT', 'BATTERY', 'CRIMINAL DAMAGE', 'NARCOTICS', 'ASSAULT', 'MOTOR VEHICLE THEFT', 'ROBERRY','BURGLARY')
length(z)
library(lme4)
library (ggplot2)
setwd('/Users/Mowafak/Documents/Tribune/weather_Temp & shootings/Stats Analysis/')
data <- read.csv('temp_reg_analysis.csv')
data$X <- NULL
mlm.1 <- lmer(Count~poly(Mean_Temp,2,raw = TRUE)+(1|Year)+(1|Primary.Type),data=data,REML = FALSE)
summary(mlm.1)
ranef(mlm.1)
library(lme4)
library (ggplot2)
setwd('/Users/Mowafak/Documents/Tribune/weather_Temp & shootings/Stats Analysis/')
data <- read.csv('temp_reg_analysis.csv')
data$X <- NULL
# sM<-lm(Count ~ Primary.Type + Mean_Temp+Month+Year,data=data)
#
# data$Year<-factor(data$Year)
# data$Month<-factor(data$Month)
data$Primary.Type <- factor(data$Primary.Type)
# data$Day <- factor(data$Day)
levels(data$Primary.Type) <- c(levels(data$Primary.Type),'Other')
crimeType <-c('THEFT', 'BATTERY', 'CRIMINAL DAMAGE', 'NARCOTICS', 'ASSAULT', 'MOTOR VEHICLE THEFT', 'ROBERRY','BURGLARY')
data$Primary.Type[!(data$Primary.Type %in%  crimeType)]<-'Other'
data$Primary.Type<-relevel(data$Primary.Type,ref='Other')
mlm.2 <- lmer(Count~Mean_Temp*Primary.Type+(1|Year)+(1|Primary.Type),data=data,REML = FALSE)
summary(mlm.2)
?lme4
mlm <- lmer(Count~1+(1|Year)+(1|Month),data=data,REML = FALSE)
summary(mlm)
ranef(mlm)
mlm.1 <- lmer(Count~Mean_Temp+(1|Year)+(1|Primary.Type),data=data,REML = FALSE)
summary(mlm.1)
ranef(mlm.1)
levels(data$Primary.Type) <- c(levels(data$Primary.Type),'Other')
crimeType <-c('THEFT', 'BATTERY', 'CRIMINAL DAMAGE', 'NARCOTICS', 'ASSAULT', 'MOTOR VEHICLE THEFT', 'ROBERRY','BURGLARY')
data$Primary.Type[!(data$Primary.Type %in%  crimeType)]<-'Other'
data$Primary.Type<-relevel(data$Primary.Type,ref='Other')
mlm.2 <- lmer(Count~Mean_Temp*Primary.Type+(1|Year)+(1|Primary.Type),data=data,REML = FALSE)
summary(mlm.2)
library(lme4) #importing library for linear mixed models.
library (ggplot2)
setwd('/Users/Mowafak/Documents/Tribune/weather_Temp & shootings/Stats Analysis/')
data <- read.csv('temp_reg_analysis.csv')
data$X <- NULL
levels(data$Primary.Type) <- c(levels(data$Primary.Type),'Other') #recoding the crimes to "other"
crimeType <-c('THEFT', 'BATTERY', 'CRIMINAL DAMAGE', 'NARCOTICS', 'ASSAULT', 'MOTOR VEHICLE THEFT', 'ROBERRY','BURGLARY')
data$Primary.Type[!(data$Primary.Type %in%  crimeType)]<-'Other'
data$Primary.Type<-relevel(data$Primary.Type,ref='Other') #releveling the baseline to "Other"
mlm.2 <- lmer(Count~Mean_Temp*Primary.Type+(1|Year)+(1|Primary.Type),data=data,REML = FALSE)
summary(mlm.2)
View(data)
library(lme4) #importing library for linear mixed models.
library (ggplot2)
setwd('/Users/Mowafak/Documents/Tribune/weather_Temp & shootings/Stats Analysis/')
data <- read.csv('temp_reg_analysis.csv')
data$X <- NULL
data$Primary.Type <- factor(data$Primary.Type)
levels(data$Primary.Type) <- c(levels(data$Primary.Type),'Other') #recoding the crimes to "other"
crimeType <-c('THEFT', 'BATTERY', 'CRIMINAL DAMAGE', 'NARCOTICS', 'ASSAULT', 'MOTOR VEHICLE THEFT', 'ROBERRY','BURGLARY')
data$Primary.Type[!(data$Primary.Type %in%  crimeType)]<-'Other'
data$Primary.Type<-relevel(data$Primary.Type,ref='Other') #releveling the baseline to "Other"
mlm.2 <- lmer(Count~Mean_Temp*Primary.Type+(1|Year)+(1|Primary.Type),data=data,REML = FALSE)
summary(mlm.2)
library(lme4) #importing library for linear mixed models.
library (ggplot2)
setwd('/Users/Mowafak/Documents/Tribune/weather_Temp & shootings/Stats Analysis/')
data <- read.csv('temp_reg_analysis.csv')
data$X <- NULL
data$Primary.Type <- factor(data$Primary.Type)
mlm.1 <- lmer(Count~Mean_Temp+(1|Year)+(1|Primary.Type),data=data,REML = FALSE)
summary(mlm.1)
levels(data$Primary.Type) <- c(levels(data$Primary.Type),'Other') #recoding the crimes to "other"
crimeType <-c('THEFT', 'BATTERY', 'CRIMINAL DAMAGE', 'NARCOTICS', 'ASSAULT', 'MOTOR VEHICLE THEFT', 'ROBERRY','BURGLARY')
data$Primary.Type[!(data$Primary.Type %in%  crimeType)]<-'Other'
data$Primary.Type<-relevel(data$Primary.Type,ref='Other') #releveling the baseline to "Other"
mlm.2 <- lmer(Count~Mean_Temp*Primary.Type+(1|Year)+(1|Primary.Type),data=data,REML = FALSE)
summary(mlm.2)
#######################################################
# In this R script, we built a multi-level-model (MLM)
# to better understand the relationship between crime rate
# and weather temperature. This is a follow up analysis
# to a linear regression analysis that looked at the linear
# relationship between crime rate and temperature. For both
# analyses we pulled crime data from City of Chicago Data Portal
# for the past 5 years (2012 - 2017)
#
# Objective:
# We are trying to capture the effect of temperature
# on crime accounting for the variablity of each type of crime
# in each year.
#
# Method:
# Our first round of analysis we identified a total of 8
# types of crimes that had the steepest slopes in the linear
# regression model. The 8 crimes are:
#   - Theft
#   - Battery
#   - Criminal Damage
#   - Narcotics
#   - Assualt
#   - Motor Vehicle Theft
#   - Robbery
#   - Burglary
# Accordingly, we coded all other crimes as "Other" and we use this category
# as a frame of reference (baseline) for comparison in the MLM model.
#
# It's worth noting that we conducted additional analyses and we believe
# that Battery tend to include shooting incidents in chicago.
#
# Conclusion:
# Overall, we found that temperature have a significant effect on
# crime rate. Below is a summary of our results
#############################               #########   ########   #####
#Effects                                    Estimate    std.err   t-value
#############################               #########   ########   #####
# Mean_Temp:Primary.TypeASSAULT               0.335653   0.020328   16.51
# Mean_Temp:Primary.TypeBATTERY               0.949677   0.020328   46.72
# Mean_Temp:Primary.TypeBURGLARY              0.195130   0.020328    9.60
# Mean_Temp:Primary.TypeCRIMINAL DAMAGE       0.495823   0.020328   24.39
# Mean_Temp:Primary.TypeMOTOR VEHICLE THEFT   0.028752   0.020328    1.41
# Mean_Temp:Primary.TypeNARCOTICS             0.070149   0.020328    3.45
# Mean_Temp:Primary.TypeTHEFT                 0.932344   0.020328   45.87
# the measure of significance in this analysis is when the t-value
# is greater or equals to 2.
# Our analysis shows that for every 10 degrees increase in temperature,
# roughly, there is:
#   * 9 theft incidents
#   * 9 battery incidents
#   * 3 assault incidents
#   * 2 burgulary incidents
#   * 1 incident related to narcotics
# the effect of Motor vehicle theft turned out to be statistically
#insignificant. Therefore, we decided not report it.
#######################################################
library(lme4) #importing library for linear mixed models.
library (ggplot2)
setwd('/Users/Mowafak/Documents/Tribune/weather_Temp & shootings/Stats Analysis/')
data <- read.csv('temp_reg_analysis.csv')
data$X <- NULL
data$Primary.Type <- factor(data$Primary.Type)
#Structuring the MLM model:
# In this model we are trying to find the temperature on crime
# controlling for the variation of year and type of crime.
# In other words, we allow each Year and each type of Crime to have their
# own means.
mlm.1 <- lmer(Count~Mean_Temp+(1|Year)+(1|Primary.Type),data=data,REML = FALSE)
summary(mlm.1)
ranef(mlm.1)
# Conclusion: overall, for every 10 units increase in temperature,
# roughly, there are 13 crime incidents.
# Now in order to measure the effect of each type of crime and temperature on
# crime rate, we interact crime type and temperature. Since we are interested
# in only 8 crimes with the steepest slopes, we coded all other cirme types in
# the following analysis as other.
####Dummy code the variables
levels(data$Primary.Type) <- c(levels(data$Primary.Type),'Other') #recoding the crimes to "other"
crimeType <-c('THEFT', 'BATTERY', 'CRIMINAL DAMAGE', 'NARCOTICS', 'ASSAULT', 'MOTOR VEHICLE THEFT', 'ROBERRY','BURGLARY')
data$Primary.Type[!(data$Primary.Type %in%  crimeType)]<-'Other'
data$Primary.Type<-relevel(data$Primary.Type,ref='Other') #releveling the baseline to "Other"
mlm.2 <- lmer(Count~Mean_Temp*Primary.Type+(1|Year)+(1|Primary.Type),data=data,REML = FALSE)
summary(mlm.2)
# The interaction terms represent the slope of the interaction term in each row.
# The intercepts represent the point where the linear line starts for each
# crime type at x=0.
# Interpretation of slopes:
# e.g., for Mean_Temp:Primary.TypeASSAULT for every 10 units increase in temperature
# there are 3 assault incidents above the average of other crimes.
